var Autocomplete=function(){"use strict";function e(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function t(t){for(var n=1;n<arguments.length;n++){var s=null!=arguments[n]?arguments[n]:{},o=Object.keys(s);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(s).filter(function(e){return Object.getOwnPropertyDescriptor(s,e).enumerable}))),o.forEach(function(n){e(t,n,s[n])})}return t}var n=function(e,t){return e.matches?e.matches(t):e.msMatchesSelector?e.msMatchesSelector(t):e.webkitMatchesSelector?e.webkitMatchesSelector(t):null},s=function(e,t){return e.closest?e.closest(t):function(e,t){for(var s=e;s&&1===s.nodeType;){if(n(s,t))return s;s=s.parentNode}return null}(e,t)},o=function t(){var n,o=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=i.search,l=i.autoSelect,u=void 0!==l&&l,a=i.setValue,d=void 0===a?function(){}:a,c=i.setAttribute,h=void 0===c?function(){}:c,p=i.onUpdate,f=void 0===p?function(){}:p,v=i.onSubmit,b=void 0===v?function(){}:v,m=i.onShow,g=void 0===m?function(){}:m,w=i.onHide,x=void 0===w?function(){}:w,y=i.onLoading,L=void 0===y?function(){}:y,R=i.onLoaded,S=void 0===R?function(){}:R;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e(this,"value",""),e(this,"searchCounter",0),e(this,"results",[]),e(this,"selectedIndex",-1),e(this,"handleInput",function(e){var t=e.target.value;o.updateResults(t),o.value=t}),e(this,"handleKeyDown",function(e){var t=e.key;switch(t){case"Up":case"Down":case"ArrowUp":case"ArrowDown":var n="ArrowUp"===t||"Up"===t?o.selectedIndex-1:o.selectedIndex+1;e.preventDefault(),o.handleArrows(n);break;case"Tab":o.selectResult();break;case"Enter":var s=o.results[o.selectedIndex];o.selectResult(),o.onSubmit(s);break;case"Esc":case"Escape":o.hideResults(),o.setValue();break;default:return}}),e(this,"handleFocus",function(e){var t=e.target.value;o.updateResults(t),o.value=t}),e(this,"handleBlur",function(){o.hideResults()}),e(this,"handleResultMouseDown",function(e){e.preventDefault()}),e(this,"handleResultClick",function(e){var t=e.target,n=s(t,"[data-result-index]");if(n){o.selectedIndex=parseInt(n.dataset.resultIndex,10);var i=o.results[o.selectedIndex];o.selectResult(),o.onSubmit(i)}}),e(this,"handleArrows",function(e){var t=o.results.length;o.selectedIndex=(e%t+t)%t,o.onUpdate(o.results,o.selectedIndex)}),e(this,"selectResult",function(){var e=o.results[o.selectedIndex];e&&o.setValue(e),o.hideResults()}),e(this,"updateResults",function(e){var t=++o.searchCounter;o.onLoading(),o.search(e).then(function(e){t===o.searchCounter&&(o.results=e,o.onLoaded(),0!==o.results.length?(o.selectedIndex=o.autoSelect?0:-1,o.onUpdate(o.results,o.selectedIndex),o.showResults()):o.hideResults())})}),e(this,"showResults",function(){o.setAttribute("aria-expanded",!0),o.onShow()}),e(this,"hideResults",function(){o.selectedIndex=-1,o.results=[],o.setAttribute("aria-expanded",!1),o.setAttribute("aria-activedescendant",""),o.onUpdate(o.results,o.selectedIndex),o.onHide()}),e(this,"checkSelectedResultVisible",function(e){var t=e.querySelector('[data-result-index="'.concat(o.selectedIndex,'"]'));if(t){var n=e.getBoundingClientRect(),s=t.getBoundingClientRect();s.top<n.top?e.scrollTop-=n.top-s.top:s.bottom>n.bottom&&(e.scrollTop+=s.bottom-n.bottom)}}),this.search=(n=r,Boolean(n&&"function"==typeof n.then)?r:function(e){return Promise.resolve(r(e))}),this.autoSelect=u,this.setValue=d,this.setAttribute=h,this.onUpdate=f,this.onSubmit=b,this.onShow=g,this.onHide=x,this.onLoading=L,this.onLoaded=S},i=0,r=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return"".concat(e).concat(++i)};var l=function(e,t,n,s,o,i,r,l,u,a){"boolean"!=typeof r&&(u=l,l=r,r=!1);var d,c="function"==typeof n?n.options:n;if(e&&e.render&&(c.render=e.render,c.staticRenderFns=e.staticRenderFns,c._compiled=!0,o&&(c.functional=!0)),s&&(c._scopeId=s),i?(d=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),t&&t.call(this,u(e)),e&&e._registeredComponents&&e._registeredComponents.add(i)},c._ssrRegister=d):t&&(d=r?function(){t.call(this,a(this.$root.$options.shadowRoot))}:function(e){t.call(this,l(e))}),d)if(c.functional){var h=c.render;c.render=function(e,t){return d.call(t),h(e,t)}}else{var p=c.beforeCreate;c.beforeCreate=p?[].concat(p,d):[d]}return n}({render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"root"},[e._t("default",[n("div",e._b({},"div",e.rootProps,!1),[n("input",e._g(e._b({ref:"input",on:{input:e.handleInput,keydown:e.core.handleKeyDown,focus:e.core.handleFocus,blur:e.core.handleBlur}},"input",e.inputProps,!1),e.$listeners)),e._v(" "),n("ul",e._g(e._b({ref:"resultList"},"ul",e.resultListProps,!1),e.resultListListeners),[e._l(e.results,function(t,s){return[e._t("result",[n("li",e._b({key:e.resultProps[s].id},"li",e.resultProps[s],!1),[e._v("\n              "+e._s(e.getResultValue(t))+"\n            ")])],{result:t,props:e.resultProps[s]})]})],2)])],{rootProps:e.rootProps,inputProps:e.inputProps,inputListeners:e.inputListeners,resultListProps:e.resultListProps,resultListListeners:e.resultListListeners,results:e.results,resultProps:e.resultProps})],2)},staticRenderFns:[]},void 0,{name:"Autocomplete",inheritAttrs:!1,props:{search:{type:Function,required:!0},baseClass:{type:String,default:"autocomplete"},autoSelect:{type:Boolean,default:!1},getResultValue:{type:Function,default:function(e){return e}},defaultValue:{type:String,default:""},debounceTime:{type:Number,default:0}},data:function(){var e,t,n,s,i=new o({search:this.search,autoSelect:this.autoSelect,setValue:this.setValue,onUpdate:this.handleUpdate,onSubmit:this.handleSubmit,onShow:this.handleShow,onHide:this.handleHide,onLoading:this.handleLoading,onLoaded:this.handleLoaded});return this.debounceTime>0&&(i.handleInput=(e=i.handleInput,t=this.debounceTime,function(){var o=this,i=arguments,r=n&&!s;clearTimeout(s),s=setTimeout(function(){s=null,n||e.apply(o,i)},t),r&&e.apply(o,i)})),{core:i,value:this.defaultValue,resultListId:r("".concat(this.baseClass,"-result-list-")),results:[],selectedIndex:-1,expanded:!1,loading:!1,position:"below",resetPosition:!0}},computed:{rootProps:function(){return{class:this.baseClass,style:{position:"relative"},"data-expanded":this.expanded,"data-loading":this.loading,"data-position":this.position}},inputProps:function(){return t({class:"".concat(this.baseClass,"-input"),value:this.value,role:"combobox",autocomplete:"off",autocapitalize:"off",autocorrect:"off",spellcheck:"false","aria-autocomplete":"list","aria-haspopup":"listbox","aria-owns":this.resultListId,"aria-expanded":this.expanded?"true":"false","aria-activedescendant":this.selectedIndex>-1?this.resultProps[this.selectedIndex].id:""},this.$attrs)},inputListeners:function(){return{input:this.handleInput,keydown:this.core.handleKeyDown,focus:this.core.handleFocus,blur:this.core.handleBlur}},resultListProps:function(){var t="below"===this.position?"top":"bottom";return{id:this.resultListId,class:"".concat(this.baseClass,"-result-list"),role:"listbox",style:e({position:"absolute",zIndex:1,width:"100%",visibility:this.expanded?"visible":"hidden",pointerEvents:this.expanded?"auto":"none"},t,"100%")}},resultListListeners:function(){return{mousedown:this.core.handleResultMouseDown,click:this.core.handleResultClick}},resultProps:function(){var e=this;return this.results.map(function(n,s){return t({id:"".concat(e.baseClass,"-result-").concat(s),class:"".concat(e.baseClass,"-result"),"data-result-index":s,role:"option"},e.selectedIndex===s?{"aria-selected":"true"}:{})})}},mounted:function(){document.body.addEventListener("click",this.handleDocumentClick)},beforeDestroy:function(){document.body.removeEventListener("click",this.handleDocumentClick)},updated:function(){var e,t,n,s;this.$refs.input&&this.$refs.resultList&&(this.resetPosition&&this.results.length>0&&(this.resetPosition=!1,this.position=(e=this.$refs.input,t=this.$refs.resultList,n=e.getBoundingClientRect(),s=t.getBoundingClientRect(),n.bottom+s.height>window.innerHeight&&window.innerHeight-n.bottom<n.top&&window.pageYOffset+n.top-s.height>0?"above":"below")),this.core.checkSelectedResultVisible(this.$refs.resultList))},methods:{setValue:function(e){this.value=e?this.getResultValue(e):""},handleUpdate:function(e,t){this.results=e,this.selectedIndex=t},handleShow:function(){this.expanded=!0},handleHide:function(){this.expanded=!1,this.resetPosition=!0},handleLoading:function(){this.loading=!0},handleLoaded:function(){this.loading=!1},handleInput:function(e){this.value=e.target.value,this.core.handleInput(e)},handleSubmit:function(e){this.$emit("submit",e)},handleDocumentClick:function(e){this.$refs.root.contains(e.target)||this.core.hideResults()}}},void 0,!1,void 0,void 0,void 0);function u(e){u.installed||(u.installed=!0,e.component("Autocomplete",l))}var a,d={install:u};return"undefined"!=typeof window?a=window.Vue:"undefined"!=typeof global&&(a=global.Vue),a&&a.use(d),l.install=u,l}();
